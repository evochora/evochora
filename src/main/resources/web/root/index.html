<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evochora</title>
    <link rel="icon" type="image/x-icon" href="/favicons/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/favicons/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/favicons/android-chrome-512x512.png">
    <link rel="manifest" href="/favicons/site.webmanifest">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Doto:wght@900&family=Source+Serif+4:ital,opsz,wght@0,8..60,300;0,8..60,400;0,8..60,600;1,8..60,400&family=IBM+Plex+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/shared/app-switcher/app-switcher.css">
    <style>
        :root {
            --bg-deep: #08080f;
            --bg-mid: #0e0e18;
            --bg-surface: rgba(255, 255, 255, 0.03);
            --bg-surface-hover: rgba(255, 255, 255, 0.06);
            --border: rgba(255, 255, 255, 0.08);
            --border-hover: rgba(255, 255, 255, 0.15);
            --text-primary: #d8d8de;
            --text-secondary: rgba(216, 216, 222, 0.7);
            --text-tertiary: rgba(216, 216, 222, 0.5);
            --accent: #4a9eff;
            --accent-dim: rgba(74, 158, 255, 0.15);
            --accent-glow: rgba(74, 158, 255, 0.08);
            --serif: 'Source Serif 4', Georgia, serif;
            --sans: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --doto: 'Doto', monospace;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--sans);
            background: var(--bg-deep);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .page {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 3rem 2rem 4rem;
            display: flex;
            flex-direction: column;
        }

        /* ── Logo ── */
        .logo {
            text-align: center;
            padding: 1rem 0 2.5rem;
        }

        .logo-text {
            font-family: var(--doto);
            font-weight: 900;
            font-size: 56px;
            color: var(--text-primary);
            letter-spacing: 6px;
            line-height: 1;
            opacity: 0.85;
        }

        .logo-sub {
            font-family: var(--serif);
            font-size: 0.95rem;
            font-weight: 300;
            color: var(--text-tertiary);
            margin-top: 0.5rem;
            letter-spacing: 0.5px;
        }

        /* ── Dividers ── */
        .divider {
            border: none;
            height: 1px;
            background: var(--border);
            margin: 2.5rem 0;
        }

        /* ── Hero ── */
        .hero {
            display: flex;
            gap: 2.5rem;
            align-items: flex-start;
        }

        .hero-text {
            flex: 1 1 380px;
            min-width: 280px;
        }

        .hero-headline {
            font-family: var(--serif);
            font-size: 1.75rem;
            font-weight: 600;
            line-height: 1.35;
            color: var(--text-primary);
            margin-bottom: 1.25rem;
        }

        .hero-body {
            font-family: var(--serif);
            font-size: 1.05rem;
            font-weight: 400;
            line-height: 1.75;
            color: var(--text-secondary);
        }

        .hero-video {
            flex: 1 1 420px;
            min-width: 300px;
        }

        .demo-video {
            width: 100%;
            border-radius: 4px;
            border: 1px solid var(--border);
        }

        .video-caption {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            margin-top: 0.5rem;
            font-style: italic;
            font-family: var(--serif);
        }

        /* ── Action Cards ── */
        .actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .action-card {
            display: flex;
            flex-direction: column;
        }

        .action-card-img-link {
            display: block;
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid var(--border);
            transition: border-color 0.2s ease, transform 0.2s ease;
        }

        .action-card-img-link:hover {
            border-color: var(--border-hover);
            transform: scale(1.02);
        }

        .action-card-img {
            width: 100%;
            aspect-ratio: 16 / 9;
            object-fit: cover;
            display: block;
        }


        .action-card-body {
            padding: 1rem 0.25rem 0;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .action-card-title {
            font-family: var(--sans);
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.3rem;
        }

        .action-card-desc {
            font-size: 0.85rem;
            line-height: 1.5;
            color: var(--text-secondary);
            flex: 1;
        }

        .action-card-cta {
            display: inline-block;
            margin-top: 0.75rem;
            padding: 0.45rem 1rem;
            font-family: var(--sans);
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--accent);
            border: 1px solid var(--accent-dim);
            border-radius: 4px;
            text-decoration: none;
            transition: background 0.15s ease, border-color 0.15s ease;
            align-self: flex-start;
        }

        .action-card-cta:hover {
            background: var(--accent-dim);
            border-color: var(--accent);
        }

        .action-card-links {
            margin-top: 0.75rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .action-card-links a {
            color: var(--accent);
            text-decoration: none;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .action-card-links a:hover {
            text-decoration: underline;
        }

        .colab-badge {
            height: 20px;
            display: block;
        }

        /* ── Section headings ── */
        .section-title {
            font-family: var(--serif);
            font-size: 1.35rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
        }

        /* ── Why Evochora ── */
        .why-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem 6rem;
        }

        .why-item {
            padding: 0.9rem 1rem;
            border-left: 2px solid var(--accent);
            background: rgba(74, 158, 255, 0.03);
            border-radius: 0 4px 4px 0;
        }

        .why-label {
            font-family: var(--sans);
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.3rem;
        }

        .why-desc {
            font-family: var(--serif);
            font-size: 0.9rem;
            line-height: 1.65;
            color: var(--text-secondary);
        }

        /* ── Get Started ── */
        .get-started {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 2rem 2.25rem;
        }

        .get-started-title {
            font-family: var(--serif);
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }

        .get-started-body {
            font-family: var(--serif);
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text-secondary);
            margin-bottom: 1.25rem;
            max-width: 680px;
        }

        .get-started-actions {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        .btn-primary {
            display: inline-block;
            padding: 0.6rem 1.4rem;
            background: var(--accent);
            color: var(--bg-deep);
            font-family: var(--sans);
            font-size: 0.875rem;
            font-weight: 600;
            text-decoration: none;
            border-radius: 4px;
            transition: background 0.15s ease;
        }

        .btn-primary:hover {
            background: #66b3ff;
        }

        .btn-secondary {
            display: inline-block;
            padding: 0.6rem 1.4rem;
            color: var(--text-secondary);
            font-family: var(--sans);
            font-size: 0.875rem;
            font-weight: 500;
            text-decoration: none;
            border: 1px solid var(--border);
            border-radius: 4px;
            transition: border-color 0.15s ease, color 0.15s ease;
        }

        .btn-secondary:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .get-started-req {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            margin-top: 0.75rem;
        }


        /* ── Footer ── */
        .footer {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            flex-wrap: wrap;
            padding-top: 0.5rem;
        }

        .footer-link {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            transition: color 0.15s ease;
        }

        .footer-link:hover {
            color: var(--text-secondary);
        }

        .footer-sep {
            color: var(--border);
            font-size: 0.7rem;
            user-select: none;
        }

        .footer-icon {
            width: 14px;
            height: 14px;
            fill: currentColor;
            opacity: 0.8;
        }

        /* ── Responsive ── */
        @media (max-width: 900px) {
            .actions {
                grid-template-columns: 1fr 1fr;
            }

            .why-grid, .next-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 680px) {
            .site-header-inner {
                padding: 6px 1.25rem;
            }

            .page {
                padding: 2rem 1.25rem 3rem;
            }

            .logo-text {
                font-size: 40px;
                letter-spacing: 4px;
            }

            .hero {
                flex-direction: column;
                gap: 1.5rem;
            }

            .hero-headline {
                font-size: 1.4rem;
            }

            .actions {
                grid-template-columns: 1fr;
            }

            .why-grid, .next-grid {
                grid-template-columns: 1fr;
                gap: 1.25rem;
            }

            .get-started {
                padding: 1.5rem;
            }

            .divider {
                margin: 2rem 0;
            }
        }
        /* ── Next Steps (local mode) ── */
        .next-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem 6rem;
        }

        .next-item {
            padding: 0.9rem 1rem;
            border-left: 2px solid var(--accent);
            background: rgba(74, 158, 255, 0.03);
            border-radius: 0 4px 4px 0;
            display: flex;
            flex-direction: column;
        }

        .next-label {
            font-family: var(--sans);
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.3rem;
        }

        .next-desc {
            font-family: var(--serif);
            font-size: 0.9rem;
            line-height: 1.65;
            color: var(--text-secondary);
        }

        .next-links {
            margin-top: auto;
            padding-top: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .next-links a {
            color: var(--accent);
            text-decoration: none;
            font-family: var(--sans);
            font-size: 0.8rem;
            font-weight: 500;
        }

        .next-links a:hover {
            text-decoration: underline;
        }

        .next-link-sep {
            color: var(--text-tertiary);
            font-size: 0.75rem;
        }

        /* ── Node Banner ── */
        .node-banner {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1rem;
            font-size: 0.85rem;
            color: var(--accent);
            background: var(--accent-glow);
            border: 1px solid var(--accent-dim);
            border-radius: 4px;
            margin-bottom: 1.5rem;
        }

        .node-banner-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #50c878;
            flex-shrink: 0;
        }

        /* ── Run List ── */
        .run-list-title {
            font-family: var(--sans);
            font-size: 0.85rem;
            font-weight: 400;
            color: var(--text-secondary);
            margin-bottom: 0.6rem;
        }

        .run-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .run-table th {
            text-align: left;
            font-weight: 500;
            color: var(--text-tertiary);
            padding: 0.3rem 0.75rem;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .run-table th:nth-child(n+2) {
            text-align: right;
        }

        .run-table td {
            padding: 0.3rem 0.75rem;
            color: var(--text-secondary);
            font-variant-numeric: tabular-nums;
        }

        .run-table td:nth-child(n+2) {
            text-align: right;
        }

        .run-table tbody tr:hover {
            background: var(--bg-surface-hover);
        }

        .run-active td {
            color: var(--text-primary);
        }

        .run-status-badge {
            display: inline-block;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.04em;
            padding: 0.15rem 0.5rem;
            border-radius: 3px;
            margin-right: 0.5rem;
        }

        .run-status-running {
            color: #50c878;
            background: rgba(80, 200, 120, 0.1);
            border: 1px solid rgba(80, 200, 120, 0.25);
        }

        .run-status-paused {
            color: #e0c050;
            background: rgba(224, 192, 80, 0.1);
            border: 1px solid rgba(224, 192, 80, 0.25);
        }

        .run-status-error {
            color: #e05050;
            background: rgba(224, 80, 80, 0.1);
            border: 1px solid rgba(224, 80, 80, 0.25);
        }

        .run-viz-link {
            color: var(--accent);
            text-decoration: none;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .run-viz-link:hover {
            text-decoration: underline;
        }

        .run-link-sep {
            color: var(--text-tertiary);
            font-size: 0.75rem;
            margin: 0 0.15rem;
        }

        .run-list-loading, .run-list-empty, .run-list-offline {
            font-size: 0.85rem;
            color: var(--text-tertiary);
            padding: 0.5rem 0;
        }

        .node-banner-offline {
            color: #c0a050;
            background: rgba(192, 160, 80, 0.08);
            border-color: rgba(192, 160, 80, 0.2);
            margin-bottom: 0;
        }

        .node-banner-offline .node-banner-dot {
            background: #c0a050;
        }

        /* ── Sticky Header ── */
        .site-header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(8, 8, 15, 0.9);
            backdrop-filter: blur(8px);
        }

        .site-header-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1400px;
            margin: 0 auto;
            padding: 6px 2rem;
            position: relative;
        }

        .site-header-inner::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 2rem;
            right: 2rem;
            height: 1px;
            background: var(--border);
        }

        .site-header-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .site-header-logo {
            font-family: var(--doto);
            font-weight: 900;
            font-size: 16px;
            color: var(--text-primary);
            letter-spacing: 2px;
            opacity: 0.85;
            text-decoration: none;
        }

        .site-header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .site-header-icon {
            width: 18px;
            height: 18px;
            fill: var(--text-tertiary);
            transition: fill 0.15s ease;
            display: block;
        }

        .site-header-icon:hover {
            fill: var(--text-secondary);
        }

        /* App switcher sizing for LP header */
        .site-header .app-switcher-button {
            width: 22px;
            height: 22px;
            margin-right: 0;
        }

        .site-header .app-switcher-button svg {
            width: 14px;
            height: 14px;
        }

        #app-switcher-container {
            position: relative;
        }

        .site-header .app-switcher-overlay {
            position: absolute;
            top: 32px;
            left: 0;
        }

        /* ── Mode visibility (demo vs local) ── */
        [data-mode="local"] { display: none; }
        [data-mode="demo"] { display: revert; }
        body.local [data-mode="demo"] { display: none; }
        body.local [data-mode="local"] { display: revert; }
    </style>
</head>
<body>
    <!-- Sticky Header -->
    <nav class="site-header">
        <div class="site-header-inner">
            <div class="site-header-left">
                <div id="app-switcher-container"></div>
                <span class="site-header-logo">EVOCHORA</span>
            </div>
            <div class="site-header-right">
                <a href="https://github.com/evochora/evochora" target="_blank" rel="noopener noreferrer" title="GitHub">
                    <svg class="site-header-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                </a>
                <a href="https://discord.gg/t9yEJc4MKX" target="_blank" rel="noopener noreferrer" title="Discord">
                    <svg class="site-header-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.095 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.095 2.157 2.42 0 1.333-.947 2.418-2.157 2.418z"/>
                    </svg>
                </a>
            </div>
        </div>
    </nav>

    <div class="page">

        <!-- Logo -->
        <header class="logo">
            <div class="logo-text">EVOCHORA</div>
            <div class="logo-sub">Simulation Platform for Digital Evolution Research</div>
        </header>

        <!-- Hero -->
        <section class="hero">
            <div class="hero-text">
                <h1 class="hero-headline">Welcome to Evochora</h1>
                <p class="hero-body">
                    Evochora provides a complete tool stack for digital evolution research &mdash; from
                    authoring self-replicating organisms to analyzing the evolutionary dynamics and results.
                </p>
                <p class="hero-body" style="margin-top: 0.75rem;">
                    Organisms are written in EvoASM, a purpose-built assembly language. They inhabit an
                    n-dimensional environment governed by configurable thermodynamics. Mutation mechanics,
                    resource dynamics, and death conditions are fully programmable through swappable
                    plugins &mdash; even the EvoASM instruction set itself.
                </p>
                <p class="hero-body" style="margin-top: 0.75rem;">
                    A built-in visualizer lets you inspect and debug individual organisms during simulation:
                    registers, stacks, thermodynamic state, and executed code. The analyzer tracks population
                    dynamics, genome diversity, generation depth, and more. For deeper analysis, a data
                    pipeline exports all generated data as industry-standard Parquet files &mdash; ready
                    for Python, R, DuckDB, or your preferred tools.
                </p>
            </div>
            <div class="hero-video">
                <video class="demo-video" autoplay muted loop playsinline preload="auto"
                       poster="/favicons/video-poster.png">
                    <source src="https://github.com/user-attachments/assets/69b33e5b-074b-46d6-917c-9b9cf06e10ef"
                            type="video/mp4">
                </video>

            </div>
        </section>

        <hr class="divider">

        <!-- Node Banner (JS-controlled: success on local, offline on both) -->
        <div class="node-banner" id="node-banner" style="display: none;">
            <span class="node-banner-dot"></span>
            <span id="node-banner-text"></span>
        </div>

        <!-- Simulation Runs -->
        <section id="run-list">
            <div class="run-list-loading">Loading simulation data&hellip;</div>
        </section>

        <hr class="divider" id="run-list-divider">

        <!-- Action Cards -->
        <section class="actions">
            <div class="action-card">
                <a href="/visualizer" class="action-card-img-link">
                    <img class="action-card-img" src="/screenshots/visualizer.png"
                         alt="Evochora Visualizer showing organism grid, registers, and assembly debugger">
                </a>
                <div class="action-card-body">
                    <div class="action-card-title">Visualizer</div>
                    <div class="action-card-desc">
                        Inspect organisms tick-by-tick &mdash; registers, stacks, thermodynamic state, and executed code.
                    </div>
                    <a href="/visualizer" class="action-card-cta">Open Visualizer</a>
                </div>
            </div>

            <div class="action-card">
                <a href="/analyzer" class="action-card-img-link">
                    <img class="action-card-img" src="/screenshots/analyzer.png"
                         alt="Evochora Analyzer showing population dynamics, birth rates, and generation depth charts">
                </a>
                <div class="action-card-body">
                    <div class="action-card-title">Analyzer</div>
                    <div class="action-card-desc">
                        Population dynamics, genome diversity, simulation metrics, and more.
                    </div>
                    <a href="/analyzer" class="action-card-cta">Open Analyzer</a>
                </div>
            </div>

            <div class="action-card">
                <a href="https://colab.research.google.com/github/evochora/evochora/blob/main/notebooks/data_analysis_guide.ipynb?flush_cache=true"
                   target="_blank" rel="noopener noreferrer" class="action-card-img-link">
                    <img class="action-card-img" src="/screenshots/notebook.png"
                         alt="Muller Plot showing lineage clade dynamics over evolutionary time">
                </a>
                <div class="action-card-body">
                    <div class="action-card-title">Jupyter Notebook</div>
                    <div class="action-card-desc">
                        Explore simulation data with pandas, networkx, and DuckDB &mdash; phylogenetic trees, Muller plots, and more.
                    </div>
                    <div class="action-card-links">
                        <a href="https://colab.research.google.com/github/evochora/evochora/blob/main/notebooks/data_analysis_guide.ipynb?flush_cache=true"
                           target="_blank" rel="noopener noreferrer">
                            <img class="colab-badge"
                                 src="https://colab.research.google.com/assets/colab-badge.svg"
                                 alt="Open in Colab">
                        </a>
                        <a href="/notebooks/data_analysis_guide.ipynb" download>Download Notebook</a>
                    </div>
                </div>
            </div>
        </section>

        <hr class="divider" data-mode="demo">

        <!-- Why Evochora (demo only) -->
        <section data-mode="demo">
            <h2 class="section-title">Why Evochora?</h2>
            <div class="why-grid">
                <div class="why-item">
                    <div class="why-label">The physics are the experiment</div>
                    <div class="why-desc">
                        An n-dimensional environment, configurable thermodynamics, swappable mutation and death
                        mechanics, and an extensible assembly instruction set &mdash; every aspect of the world
                        is an experimental variable.
                    </div>
                </div>
                <div class="why-item">
                    <div class="why-label">From simulation to science</div>
                    <div class="why-desc">
                        A complete data pipeline exports everything as Parquet files.
                        Analyze with Python, R, Jupyter, or DuckDB &mdash; bring your own methods.
                    </div>
                </div>
                <div class="why-item">
                    <div class="why-label">Deterministic &amp; reproducible</div>
                    <div class="why-desc">
                        Seed-based simulation with complete state persistence.
                        Every experiment is perfectly reproducible.
                    </div>
                </div>
                <div class="why-item">
                    <div class="why-label">Open source, MIT licensed</div>
                    <div class="why-desc">
                        Use it, extend it, build on it. No restrictions.
                    </div>
                </div>
            </div>
        </section>

        <hr class="divider" data-mode="demo">

        <!-- Get Started (demo only) -->
        <section class="get-started" data-mode="demo">
            <h2 class="get-started-title">Run Your Own Instance</h2>
            <p class="get-started-body">
                This demo hosts a set of simulations with default settings. To design your own experiments &mdash;
                custom organisms, different physics, alternative mutation strategies &mdash; run your own Evochora node.
            </p>
            <div class="get-started-actions">
                <a href="https://github.com/evochora/evochora/releases" class="btn-primary"
                   target="_blank" rel="noopener noreferrer">Download Latest Release</a>
                <a href="https://github.com/evochora/evochora#quick-start" class="btn-secondary"
                   target="_blank" rel="noopener noreferrer">Read the Quick Start Guide</a>
            </div>
            <div class="get-started-req">Open Source: <a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer" style="color: inherit;">MIT License</a> · Requires Java 21</div>
        </section>

        <hr class="divider">

        <!-- What's Next (both modes) -->
        <section>
            <h2 class="section-title">What's Next</h2>
            <div class="next-grid">
                <div class="next-item">
                    <div class="next-label">Get Help</div>
                    <div class="next-desc">
                        Questions, ideas, feedback &mdash; reach out.
                    </div>
                    <div class="next-links">
                        <a href="https://github.com/evochora/evochora/discussions" target="_blank" rel="noopener noreferrer">
                            <img src="https://img.shields.io/badge/GitHub-Discussions-181717?logo=github&logoColor=white" alt="GitHub Discussions" style="height: 20px;">
                        </a>
                        <a href="https://discord.gg/t9yEJc4MKX" target="_blank" rel="noopener noreferrer">
                            <img src="https://img.shields.io/badge/Discord-Join-5865F2?logo=discord&logoColor=white" alt="Discord" style="height: 20px;">
                        </a>
                    </div>
                </div>
                <div class="next-item">
                    <div class="next-label">Configure Your Simulation</div>
                    <div class="next-desc">
                        Customize thermodynamics, mutation rates, energy dynamics, and environment parameters.
                    </div>
                    <div class="next-links">
                        <a href="https://github.com/evochora/evochora/blob/main/evochora.conf" target="_blank" rel="noopener noreferrer">Configuration Reference</a>
                    </div>
                </div>
                <div class="next-item">
                    <div class="next-label">Write Organisms</div>
                    <div class="next-desc">
                        Create digital organisms in EvoASM, a purpose-built assembly language for self-replicating programs.
                    </div>
                    <div class="next-links">
                        <a href="https://github.com/evochora/evochora/blob/main/docs/ASSEMBLY_SPEC.md" target="_blank" rel="noopener noreferrer">Assembly Spec</a>
                        <span class="next-link-sep">|</span>
                        <a href="https://github.com/evochora/evochora/tree/main/assembly" target="_blank" rel="noopener noreferrer">Examples</a>
                        <span class="next-link-sep">|</span>
                        <a href="https://github.com/evochora/evochora/tree/main/extensions" target="_blank" rel="noopener noreferrer">Syntax Highlighting</a>
                    </div>
                </div>
                <div class="next-item">
                    <div class="next-label">Build Plugins</div>
                    <div class="next-desc">
                        Write custom plugins for mutation strategies, death mechanics, energy sources, and more.
                    </div>
                    <div class="next-links">
                        <a href="https://github.com/evochora/evochora/tree/main/src/main/java/org/evochora/runtime/worldgen" target="_blank" rel="noopener noreferrer">Reference Plugins</a>
                    </div>
                </div>
                <div class="next-item">
                    <div class="next-label">CLI Tools</div>
                    <div class="next-desc">
                        Render simulation videos, compile EvoASM organisms, and inspect storage from the command line.
                    </div>
                    <div class="next-links">
                        <a href="https://github.com/evochora/evochora/blob/main/docs/CLI_USAGE.md" target="_blank" rel="noopener noreferrer">CLI Reference</a>
                    </div>
                </div>
                <div class="next-item">
                    <div class="next-label">API Documentation</div>
                    <div class="next-desc">
                        REST API for visualization, analytics, and service management.
                    </div>
                    <div class="next-links">
                        <a href="/api-docs">OpenAPI Reference</a>
                    </div>
                </div>
                <div class="next-item">
                    <div class="next-label">Scientific Overview</div>
                    <div class="next-desc">
                        Theoretical foundations, design decisions, and the computational model behind Evochora.
                    </div>
                    <div class="next-links">
                        <a href="https://github.com/evochora/evochora/blob/main/docs/SCIENTIFIC_OVERVIEW.md" target="_blank" rel="noopener noreferrer">Read the Paper</a>
                    </div>
                </div>
                <div class="next-item">
                    <div class="next-label">Contribute</div>
                    <div class="next-desc">
                        Open source, MIT licensed. Bug reports, ideas, and pull requests are welcome.
                    </div>
                    <div class="next-links">
                        <a href="https://github.com/evochora/evochora/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">Contributing Guide</a>
                        <span class="next-link-sep">|</span>
                        <a href="https://github.com/evochora/evochora/issues?q=state%3Aopen%20label%3A%22action%3A%20good%20first%20issue%22" target="_blank" rel="noopener noreferrer">Good First Issues</a>
                        <span class="next-link-sep">|</span>
                        <a href="https://github.com/orgs/evochora/projects/1" target="_blank" rel="noopener noreferrer">Project Roadmap</a>
                    </div>
                </div>
            </div>
        </section>

        <hr class="divider">

        <!-- Footer -->
        <footer class="footer">
            <a href="https://github.com/evochora/evochora" class="footer-link" target="_blank" rel="noopener noreferrer">
                <svg class="footer-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
                GitHub
            </a>
            <span class="footer-sep">&middot;</span>
            <a href="https://discord.gg/t9yEJc4MKX" class="footer-link" target="_blank" rel="noopener noreferrer">
                <svg class="footer-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.095 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.095 2.157 2.42 0 1.333-.947 2.418-2.157 2.418z"/>
                </svg>
                Discord
            </a>
            <span class="footer-sep">&middot;</span>
            <a href="/api-docs" class="footer-link">API Documentation</a>
            <span class="footer-sep">&middot;</span>
            <a href="https://github.com/evochora/evochora/blob/main/docs/SCIENTIFIC_OVERVIEW.md"
               class="footer-link" target="_blank" rel="noopener noreferrer">Scientific Overview</a>
            <span class="footer-sep">&middot;</span>
            <a href="https://opensource.org/licenses/MIT" class="footer-link" target="_blank" rel="noopener noreferrer">MIT License</a>
        </footer>

    </div>
    <script type="module">
        import { AppSwitcher } from '/shared/app-switcher/AppSwitcher.js';
        try {
            const container = document.getElementById('app-switcher-container');
            const response = await fetch('/shared/app-switcher/apps.json');
            const apps = await response.json();
            new AppSwitcher({
                element: container,
                apps: apps,
                getState: () => ({})
            });
        } catch (e) {
            console.error('Failed to initialize AppSwitcher:', e);
        }
    </script>
    <script>
    (function() {
        'use strict';

        // ── Mode detection ──
        var DEMO_HOSTS = ['evochora.org', 'www.evochora.org'];
        var isLocal = !DEMO_HOSTS.includes(window.location.hostname);
        if (isLocal) {
            document.body.classList.add('local');
        }

        // ── State ──
        var runData = {};
        var activeRunId = null;
        var systemOnline = true;

        // ── API helper with timeout ──
        function fetchJSON(url, timeoutMs) {
            timeoutMs = timeoutMs || 10000;
            var controller = new AbortController();
            var timer = setTimeout(function() { controller.abort(); }, timeoutMs);
            return fetch(url, { signal: controller.signal })
                .then(function(res) {
                    clearTimeout(timer);
                    if (!res.ok) return null;
                    return res.json();
                })
                .catch(function() {
                    clearTimeout(timer);
                    return null;
                });
        }

        // ── Data fetchers ──
        function fetchRuns() {
            return fetchJSON('/analyzer/api/runs').then(function(runs) {
                if (!runs) {
                    systemOnline = false;
                    runData = {};
                    activeRunId = null;
                    return;
                }
                systemOnline = true;
                var ids = {};
                runs.forEach(function(r) {
                    ids[r.runId] = true;
                    if (!runData[r.runId]) {
                        runData[r.runId] = { runId: r.runId, startTime: r.startTime };
                    }
                });
                Object.keys(runData).forEach(function(id) {
                    if (!ids[id]) delete runData[id];
                });
            });
        }

        function fetchTicks(runId) {
            return fetchJSON('/visualizer/api/organisms/ticks?runId=' + encodeURIComponent(runId))
                .then(function(data) {
                    if (data) {
                        runData[runId].maxTick = data.maxTick;
                    }
                });
        }

        function fetchMetadata(runId) {
            if (runData[runId].samplingInterval !== undefined) return Promise.resolve();
            return fetchJSON('/visualizer/api/simulation/metadata?runId=' + encodeURIComponent(runId))
                .then(function(data) {
                    if (data) {
                        if (data.samplingInterval !== undefined) {
                            runData[runId].samplingInterval = data.samplingInterval;
                        }
                        if (data.environment && data.environment.shape) {
                            runData[runId].shape = data.environment.shape;
                        }
                    }
                });
        }

        function fetchOrganisms(runId) {
            var maxTick = runData[runId].maxTick;
            if (maxTick === undefined) return Promise.resolve();
            return fetchJSON('/visualizer/api/organisms/' + maxTick + '?runId=' + encodeURIComponent(runId))
                .then(function(data) {
                    if (data && data.organisms) {
                        runData[runId].organismsAlive = data.organisms.length;
                        runData[runId].organismsTotal = data.totalOrganismCount;
                    }
                });
        }

        function fetchPipelineStatus() {
            return fetchJSON('/pipeline/api/status', 15000).then(function(status) {
                if (!status) return;
                activeRunId = status.activeRunId || null;
                if (activeRunId && runData[activeRunId]) {
                    var simEngine = (status.services || []).find(function(s) {
                        return s.name === 'simulation-engine';
                    });
                    if (simEngine) {
                        runData[activeRunId]._engineState = simEngine.state;
                    }
                }
            });
        }

        // ── Formatting ──
        function fmt(n) {
            if (n === undefined || n === null) return '\u2014';
            return Number(n).toLocaleString('en-US');
        }

        function fmtTimestamp(runId) {
            var m = runId.match(/^(\d{4})(\d{2})(\d{2})-(\d{2})(\d{2})(\d{2})/);
            if (!m) return runId.substring(0, 15);
            return m[1] + '-' + m[2] + '-' + m[3] + ' ' + m[4] + ':' + m[5];
        }

        // ── Banner ──
        function updateBanner() {
            var banner = document.getElementById('node-banner');
            var text = document.getElementById('node-banner-text');
            if (!systemOnline && isLocal) {
                banner.style.display = 'flex';
                banner.classList.add('node-banner-offline');
                text.textContent = 'Evochora node is not reachable.';
            } else if (systemOnline && isLocal) {
                banner.style.display = 'flex';
                banner.classList.remove('node-banner-offline');
                text.textContent = 'Your Evochora node is running.';
            } else {
                banner.style.display = 'none';
                banner.classList.remove('node-banner-offline');
            }
        }

        // ── Render ──
        function render() {
            var el = document.getElementById('run-list');
            updateBanner();

            if (!systemOnline) {
                el.innerHTML = '';
                return;
            }

            var runs = Object.values(runData).sort(function(a, b) {
                return (b.startTime || 0) - (a.startTime || 0);
            });

            if (runs.length === 0) {
                el.innerHTML = '<div class="run-list-empty">No simulation runs available yet.</div>';
                return;
            }

            var h = '<div class="run-list-title">Simulation runs available on this instance:</div>';
            h += '<table class="run-table"><thead><tr>';
            h += '<th>Started</th><th>Environment</th><th>Sampling</th><th>Ticks</th><th>Organisms</th><th></th>';
            h += '</tr></thead><tbody>';

            runs.forEach(function(run) {
                var isActive = run.runId === activeRunId;
                var cls = isActive ? ' class="run-active"' : '';
                var encodedId = encodeURIComponent(run.runId);
                h += '<tr' + cls + '>';
                h += '<td>' + fmtTimestamp(run.runId);
                if (isActive && run._engineState) {
                    var state = run._engineState;
                    var badgeCls = 'run-status-badge ';
                    if (state === 'RUNNING') badgeCls += 'run-status-running';
                    else if (state === 'PAUSED') badgeCls += 'run-status-paused';
                    else if (state === 'ERROR') badgeCls += 'run-status-error';
                    h += ' <span class="' + badgeCls + '">' + state + '</span>';
                }
                h += '</td>';
                h += '<td>' + (run.shape ? run.shape.join(' \u00d7 ') : '\u2014') + '</td>';
                h += '<td>' + fmt(run.samplingInterval) + '</td>';
                h += '<td>' + fmt(run.maxTick) + '</td>';
                h += '<td>' + fmt(run.organismsAlive) + (run.organismsTotal !== undefined ? ' / ' + fmt(run.organismsTotal) : '') + '</td>';
                h += '<td>';
                h += '<a href="/analyzer?runId=' + encodedId + '" class="run-viz-link">Analyzer</a>';
                h += ' <span class="run-link-sep">|</span> ';
                h += '<a href="/visualizer?runId=' + encodedId + '" class="run-viz-link">Visualizer</a>';
                h += '</td></tr>';
            });

            h += '</tbody></table>';
            el.innerHTML = h;
        }

        // ── Refresh cycles ──
        function refreshLight() {
            return fetchRuns().then(function() {
                var promises = Object.keys(runData).map(function(id) {
                    return Promise.all([fetchTicks(id), fetchMetadata(id)]);
                });
                return Promise.all(promises);
            }).then(render);
        }

        function refreshHeavy() {
            if (!systemOnline) return Promise.resolve();
            return fetchPipelineStatus().then(function() {
                var promises = Object.keys(runData).map(function(id) {
                    return fetchOrganisms(id);
                });
                return Promise.all(promises);
            }).then(render);
        }

        // ── Start ──
        refreshLight().then(refreshHeavy);
        setInterval(refreshLight, 15000);
        setInterval(refreshHeavy, 30000);
    })();
    </script>
</body>
</html>
