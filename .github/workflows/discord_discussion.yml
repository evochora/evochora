name: Discord Discussion Notification

on:
  discussion:
    types: [created, edited]

jobs:
  discord_notification:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord Notification
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        if: ${{ env.DISCORD_WEBHOOK != '' }}
        run: |
          jq -n \
            --arg category "${{ github.event.discussion.category.name }}" \
            --arg title "${{ github.event.discussion.title }}" \
            --arg author "${{ github.event.discussion.user.login }}" \
            --arg url "${{ github.event.discussion.html_url }}" \
            '{ "content": "ðŸ“¢ **New Discussion** in \($category)\n\n**\($title)**\nby \($author)\n\n\($url)" }' |
          curl -H "Content-Type: application/json" -d @- "$DISCORD_WEBHOOK"